DROP TABLE IF EXISTS user;

CREATE TABLE user (
  `id` 				INT(11)			NOT NULL AUTO_INCREMENT,
  `document` 			VARCHAR(14)				NOT NULL UNIQUE,
  `email` 				VARCHAR(50)			NOT NULL UNIQUE,
  `name` 	VARCHAR(100)			NOT NULL,
  `password` VARCHAR(255) NOT NULL,
  `updated_at` TIMESTAMP NOT NULL DEFAULT NOW() ON UPDATE NOW(),
  `created_at` TIMESTAMP NOT NULL DEFAULT NOW(),
  PRIMARY KEY (`id`)
);

DROP TABLE IF EXISTS wallet;

CREATE TABLE wallet (
  `id` 				VARCHAR(36)			NOT NULL,
  `balance` 			DECIMAL(15,2)				NOT NULL,
  `user_id` 				INT(11)			NOT NULL,
  `updated_at` TIMESTAMP NOT NULL DEFAULT NOW() ON UPDATE NOW(),
  `created_at` TIMESTAMP NOT NULL DEFAULT NOW(),
  PRIMARY KEY (`id`),
  FOREIGN KEY (`user_id`) REFERENCES user (`id`)
);

CREATE TABLE transaction_status (
  `id` 				INT(11)			NOT NULL AUTO_INCREMENT,
  `description` 			VARCHAR(100)				NOT NULL,
  `updated_at` TIMESTAMP NOT NULL DEFAULT NOW() ON UPDATE NOW(),
  `created_at` TIMESTAMP NOT NULL DEFAULT NOW(),
  PRIMARY KEY (`id`)
);

INSERT INTO onepuchman.transaction_status
(id, description)
VALUES(1, 'PROCESSING');
INSERT INTO onepuchman.transaction_status
(id, description, updated_at, created_at)
VALUES(2, 'SUCESS');
INSERT INTO onepuchman.transaction_status
(id, description, updated_at, created_at)
VALUES(3, 'FAILED');


DROP TABLE IF EXISTS transaction;

CREATE TABLE transaction (
  `code` 				VARCHAR(36)			NOT NULL,
  `amount` 			DECIMAL(15,2)				NOT NULL,
  `status_id` 				INT(11)			NOT NULL,
  `payer_id`            INT(11)         NOT NULL,
  `payee_id`            INT(11)         NOT NULL,
  `updated_at` TIMESTAMP NOT NULL DEFAULT NOW() ON UPDATE NOW(),
  `created_at` TIMESTAMP NOT NULL DEFAULT NOW(),
  PRIMARY KEY (`code`),
  FOREIGN KEY (`payer_id`) REFERENCES user (`id`),
  FOREIGN KEY (`payee_id`) REFERENCES user (`id`),
  FOREIGN KEY (`status_id`) REFERENCES transaction_status (`id`)
);

